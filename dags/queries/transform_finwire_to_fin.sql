SELECT
    PARSE_DATETIME('%E4Y%m%d-%H%M%S',
                   SUBSTR(ROW, 1, 15)) AS PTS,
    CAST(TRIM(SUBSTR(ROW, 19, 4)) AS INT64) AS Year,
    CAST(TRIM(SUBSTR(ROW, 23, 1)) AS INT64) AS Quarter,
    PARSE_DATE('%E4Y%m%d',
               TRIM(SUBSTR(ROW, 24, 8))) AS QtrStartDate,
    PARSE_DATE('%E4Y%m%d',
               TRIM(SUBSTR(ROW, 32, 8))) AS PostingDate,
    CAST(TRIM(SUBSTR(ROW, 40, 17)) AS NUMERIC) AS Revenue,
    CAST(TRIM(SUBSTR(ROW, 57, 17)) AS NUMERIC) AS Earnings,
    CAST(TRIM(SUBSTR(ROW, 74, 12)) AS NUMERIC) AS EPS,
    CAST(TRIM(SUBSTR(ROW, 86, 12)) AS NUMERIC) AS DilutedEPS,
    CAST(TRIM(SUBSTR(ROW, 98, 12)) AS NUMERIC) AS Margin,
    CAST(TRIM(SUBSTR(ROW, 110, 17)) AS NUMERIC) AS Inventory,
    CAST(TRIM(SUBSTR(ROW, 127, 17)) AS NUMERIC) AS Assets,
    CAST(TRIM(SUBSTR(ROW, 144, 17)) AS NUMERIC) AS Liabilities,
    CAST(TRIM(SUBSTR(ROW, 161, 13)) AS INT64) AS ShOut,
    CAST(TRIM(SUBSTR(ROW, 174, 13)) AS INT64) AS DilutedShOut,
    CASE
        WHEN CHAR_LENGTH(TRIM(SUBSTR(ROW, 187, 60))) <= 10 THEN SAFE_CAST(TRIM(SUBSTR(ROW, 187, 60)) AS INT64)
        ELSE
            NULL
        END
        AS CIK,
    CASE
        WHEN (CHAR_LENGTH(TRIM(SUBSTR(ROW, 187, 60))) > 10 OR SAFE_CAST(TRIM(SUBSTR(ROW, 187, 60)) AS INT64) IS NULL) THEN TRIM(SUBSTR(ROW, 187, 60))
        ELSE
            NULL
        END
        AS CompanyName
FROM
    staging.finwire
WHERE
        TRIM(SUBSTR(ROW, 16, 3)) = 'FIN';